# 제품 요구사항 문서 (PRD): jpgn_21_bot

**1. 개요 (Overview)**

*   **문서 버전:** 1.0
*   **작성일:** 2024년 5월 24일
*   **봇 이름:** `jpgn_21_bot`
*   **봇 설명:** 정의당 경남도당 구성원들의 구글 캘린더, Todoist, 날씨 정보를 통합하여 매일 아침과 저녁에 팀 일정 및 주요 할 일 알림을 제공하여 업무 효율성을 높이는 봇입니다.
*   **대상 사용자:** 정의당 경남도당 내부 구성원 (상근자, 주요 당직자 등 팀 업무 관리가 필요한 사람들)
*   **기대 효과:**
    *   팀 구성원의 시간 관리 효율성 증대 및 업무 조율 용이
    *   주요 당내 일정 및 팀 공통 할 일 누락 방지
    *   정보 확인 및 공유를 위한 번거로움 감소, 업무 집중도 향상

**2. 목표 (Goals)**

*   **사용자 목표:**
    *   매일 아침, 오늘 팀 전체 및 개인의 주요 일정(구글 캘린더)과 할 일(Todoist 작업) 및 관련 지역 날씨 정보를 한눈에 파악한다.
    *   매일 저녁, 다음 날 팀 일정을 미리 확인하고 오늘 마무리하지 못한 주요 업무를 점검한다.
    *   텔레그램 내에서 간편하게 팀의 주요 정보를 확인하고 공유한다.
*   **봇 목표 (비즈니스 목표로 확장 가능):**
    *   안정적으로 팀 구성원에게 정확한 정보를 제공한다.
    *   팀의 중요 정보(API 키, 연동 정보 등)를 안전하게 관리한다.
    *   향후 사용자의 피드백을 반영하여 지속적으로 기능을 개선하고 사용성을 높인다.

**3. 기능 요구사항 (Functional Requirements)**

*   **FR1: 구글 캘린더 연동**
    *   **FR1.1:** 팀(또는 담당자)은 정의당 경남도당의 주요 구글 캘린더 계정(들)을 봇에 안전하게 연동할 수 있다. (OAuth 2.0 인증 방식 권장, 대상 캘린더 ID: `anVzdGljZWt5dW5nbmFtQGdtYWlsLmNvbQ`)
    *   **FR1.2:** 봇은 연동된 구글 캘린더에서 지정된 기간(예: 오늘, 내일, 주간, 다음주)의 팀 일정 목록을 조회할 수 있다.
    *   **FR1.3:** 조회된 일정에는 시간, 제목, 참여자, 장소, 설명(선택적) 등의 정보가 포함된다.
    *   **(선택 사항/향후 확장) FR1.4:** 봇을 통해 새로운 팀 일정을 구글 캘린더에 추가하거나 기존 일정을 수정/공유할 수 있다.
*   **FR2: Todoist 연동**
    *   **FR2.1:** 팀(또는 담당자)은 정의당 경남도당의 Todoist 계정 또는 공유 프로젝트를 봇에 안전하게 연동할 수 있다. (Todoist API 토큰 또는 OAuth 2.0 인증 방식, 대상 Todoist 프로젝트 URL: `https://app.todoist.com/app/project/21-6XwvJrcQgVppWvFp`)
    *   **FR2.2:** 봇은 연동된 Todoist에서 지정된 조건(예: 오늘 마감, 특정 프로젝트, 담당자별)의 팀 작업 목록을 조회할 수 있다.
    *   **FR2.3:** 조회된 작업에는 내용, 마감일, 담당자, 프로젝트명(선택적) 등의 정보가 포함된다.
    *   **(선택 사항/향후 확장) FR2.4:** 봇을 통해 새로운 팀 작업을 Todoist에 추가하거나 기존 작업의 상태를 변경(예: 완료, 담당자 변경)할 수 있다.
*   **FR3: 날씨 정보 제공**
    *   **FR3.1:** 팀 구성원은 봇에게 특정 지역(예: 경남도당 관련 주요 활동 지역)의 날씨 정보를 요청할 수 있다.
    *   **FR3.2:** 알림에 포함될 기본 날씨 지역은 '경상남도 창원시 성산구'로 설정한다. (`/set_weather_location` 명령어로 변경 가능)
    *   **FR3.3:** 봇은 외부 날씨 API(예: 기상청 단기예보 API)를 통해 설정된 지역의 현재 날씨, 최고/최저 기온, 간단한 예보(예: 맑음, 비) 정보를 제공한다.
*   **FR4: 자동 알림 기능**
    *   **FR4.1: 아침 브리핑 알림**
        *   **FR4.1.1:** 매일 지정된 아침 시간(예: 오전 8시, 팀 설정 가능)에 알림을 발송한다.
        *   **FR4.1.2:** 알림에는 다음 정보가 포함된다:
            *   오늘의 팀 주요 구글 캘린더 일정 요약 (FR1.2, FR1.3 기반)
            *   오늘 마감 팀 Todoist 작업 목록 (FR2.2, FR2.3 기반)
            *   설정된 지역의 오늘 날씨 정보 (FR3.3 기반)
    *   **FR4.2: 저녁 준비 알림**
        *   **FR4.2.1:** 매일 지정된 저녁 시간(예: 오후 7시, 팀 설정 가능)에 알림을 발송한다.
        *   **FR4.2.2:** 알림에는 다음 정보가 포함된다:
            *   내일의 팀 주요 구글 캘린더 일정 요약 (FR1.2, FR1.3 기반)
            *   오늘 완료하지 못한 주요 팀 Todoist 작업 리마인드 (선택적, FR2.2, FR2.3 기반)
            *   설정된 지역의 내일 날씨 정보 (FR3.3 기반)
*   **FR5: 기본 봇 명령어**
    *   **FR5.1:** `/start` - 봇 시작 및 초기 안내 메시지 표시 (팀 사용 가이드 포함)
    *   **FR5.2:** `/help` - 사용 가능한 명령어 목록 및 도움말 표시
    *   **FR5.3:** `/connect_google_calendar` - 팀 구글 캘린더 연동 프로세스 시작
    *   **FR5.4:** `/connect_todoist_project` - 팀 Todoist 프로젝트 연동 프로세스 시작
    *   **FR5.5:** `/set_weather_location [지역명]` - 날씨 정보에 사용될 기본 지역 설정 (기본값: 경상남도 창원시 성산구)
    *   **FR5.6:** `/set_morning_briefing_time [HH:MM]` - 아침 브리핑 알림 시간 설정 (예: `/set_morning_briefing_time 08:00`)
    *   **FR5.7:** `/set_evening_briefing_time [HH:MM]` - 저녁 브리핑 알림 시간 설정 (예: `/set_evening_briefing_time 19:00`)
    *   **FR5.8:** `/오늘` - 오늘 팀 일정(구글 캘린더), 할 일(Todoist), 날씨 정보를 표시합니다. (FR1, FR2, FR3 기반)
    *   **FR5.9:** `/내일` - 내일 팀 일정(구글 캘린더), 할 일(Todoist), 날씨 정보를 표시합니다. (FR1, FR2, FR3 기반)
    *   **FR5.10:** `/이번주` - 이번 주 팀 일정(구글 캘린더) 및 할 일(Todoist)을 표시합니다. (FR1, FR2 기반)
    *   **FR5.11:** `/다음주` - 다음 주 팀 일정(구글 캘린더) 및 할 일(Todoist)을 표시합니다. (FR1, FR2 기반)

**4. 데이터 요구사항 (Data Requirements)**

*   **DR1: 팀 계정 연동 정보:**
    *   팀 구글 캘린더 API 접근을 위한 토큰 (암호화 저장 필수)
    *   팀 Todoist API 접근을 위한 토큰 (암호화 저장 필수)
*   **DR2: 팀 설정 정보:**
    *   알림 수신 여부
    *   알림 시간 (아침/저녁)
    *   날씨 정보 지역
*   **DR3: 외부 API:**
    *   Google Calendar API
    *   Todoist API
    *   날씨 정보 API (예: OpenWeatherMap API)

**5. 비기능 요구사항 (Non-Functional Requirements)**

*   **NFR1: 사용성 (Usability):** 명령어는 팀 구성원 누구나 직관적으로 사용하기 쉬워야 한다. 알림 메시지는 명확하고 간결해야 하며, 팀 업무에 필요한 정보를 효과적으로 전달해야 한다.
*   **NFR2: 보안 (Security):** 팀의 API 토큰 및 중요 정보는 안전하게 암호화되어 저장 및 관리되어야 한다. 접근 권한 관리가 필요할 수 있다.
*   **NFR3: 신뢰성 (Reliability):** 봇은 예정된 시간에 정확한 팀 정보를 안정적으로 제공해야 한다. API 오류 발생 시 적절한 오류 메시지를 팀 구성원에게 안내해야 한다.
*   **NFR4: 성능 (Performance):** 사용자의 요청에 대한 응답 및 알림 발송은 지연 없이 신속하게 이루어져야 한다.

**6. 성공 지표 (Success Metrics)**

*   활성 팀 구성원 수 (DAU/MAU)
*   팀 구글 캘린더/Todoist 연동 성공률 및 활성 팀 수
*   일일 팀 알림 발송 성공률
*   주요 팀 기능(`/오늘`, `/내일`, `/이번주`, `/다음주`, 자동 알림 설정 등) 사용 빈도
*   팀 구성원 만족도 (설문 또는 피드백 채널 운영 시)

**7. 릴리즈 계획 (Release Plan) - (선택 사항)**

*   **MVP (Minimum Viable Product):**
    *   FR1 (팀 구글 캘린더 읽기 전용, 지정된 ID), FR2 (팀 Todoist 공유 프로젝트 읽기 전용, 지정된 URL), FR3 (날씨 정보), FR4 (자동 알림 기능), FR5 (모든 정의된 기본 명령어) 기능 구현
    *   안정적인 정보 제공 (수동 요청 및 자동 알림) 기능에 집중
*   **향후 버전:**
    *   팀 구성원별/그룹별 알림 커스터마이징 기능 강화
    *   구글 캘린더/Todoist 쓰기 기능 (팀 일정/작업 추가, 담당자 배정, 완료 등) 추가 (권한 관리 포함)
    *   팀 내부 공지사항 전달 기능
    *   더 다양한 팀 협업 도구 연동 (예: 슬랙, 노션 등)
    *   알림 메시지 포맷 팀 설정 기능

**8. 구현 참고사항 (Implementation Notes)**

*   **텔레그램 봇 API 토큰:** `7725848868:AAF7FVSz7EN7D8VuAJGe1z42ILY_tzJaLOk`
    *   **주의:** 이 토큰은 봇을 제어할 수 있는 민감한 정보이므로, 외부 유출에 각별히 주의해야 합니다. 실제 운영 환경에서는 환경 변수 또는 비밀 관리 시스템을 통해 안전하게 관리하는 것을 권장합니다.
*   **Todoist API 설정:**
    *   **API URL:** `https://api.todoist.com/rest/v2/tasks`
    *   **API 토큰:** `5ed11504c3c02cbd47fd758ff59d6b54aa5a5926`
    *   **주의:** 이 토큰 역시 민감한 정보이므로, 외부 유출에 주의하고 실제 운영 환경에서는 안전하게 관리하는 것을 권장합니다.
*   **기상청 API 설정 (단기예보):**
    *   **API URL:** `http://apis.data.go.kr/1360000/VilageFcstInfoService_2.0`
    *   **API 키 (일반 인증키, decoding):** `uqDNGKp6ZJSvMrMKDlrlbVlsNjHM67o3IFrTjPrVaMDFQ9WSlQCYB/avrkuEEICSchbMNZUQ1Bh66GMC53/B7Q==`
    *   **주의:** 이 API 키는 공공데이터포털의 서비스키로, 사용 조건 및 일일 트래픽 제한 등을 확인하고 사용해야 합니다. 외부 유출에 주의하고 안전하게 관리하는 것을 권장합니다. 